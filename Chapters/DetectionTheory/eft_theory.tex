\section{Effective Field Theory} \label{sec:eft_theory}

\par
Given the now decades of searching for SI and SD interactions with no success, it is right to ask if the assumptions made there are still the best.
There may be dominant terms in the interaction that are ignored in the SI and SD case, such as momentum dependence.
It is, therefore, useful to approach a direct dark matter search in a more generalised way - namely via an effective field theory (EFT).
An EFT allows us to describe an unknown model by only describing the physics at a given scale \cite{eft_expo_ref}, with physics that isn't relevant being integrated out\footnote{This has rather elegantly been quoted as a way to ``parameterise our ignorance" \cite{shaunalsum_thesis_ref}}.

\par
In the remainder of this chapter, we describe the EFT description of a generalised WIMP-nucleon interaction originally presented in \cite{Fitzpatrick_2013_ref}.
Within this framework, all possible interactions in the non-relativistic limit are determined.

\subsection{Possible Operators}

\par
We begin our journey by treating the WIMP-nucleon elastic scattering as a four-field interaction comprising of the WIMP field $\chi$, the nucleon field $N$ and the effective operators $\Operator$.
In this case, the interaction Lagrangian is given by:
\begin{align}
\begin{split}
    \Lagrangian_{int} &= \chi^{+} \Operator_{\chi} \chi^{-} N^{+} \Operator_{N} N^{-} \\
                      &= \Operator \chi^{+}\chi^{-} N^{+}N^{-}
\end{split}
\label{eq:eft_initial_lagrangian}
\end{align}
We can impose constraints on the allowed interactions by applying symmetries. 
\par
Firstly, any operator must be invariant with respect to constant shifts in velocities, i.e. Galilean invariant.
This gives us four quantities with Galilean invariance: momentum transfer, $\vec{q} = \vec{p}_{\chi 1} - \vec{p}_{\chi 2} = \vec{p}_{N 2} - \vec{p}_{N 1}$, the incident WIMP velocity, $\vec{v}=\vec{v_\chi} - \vec{v}_N$, and the spins of the particles, $\vec{S}_N$ and $\vec{S}_\chi$.

\par
Next, we look at energy conservation in the centre of mass frame as it cannot change in the collision.
This allows us to equate the initial energy, $E$:
\begin{align}
    E  = \frac{1}{2}\mu_N v^2
\end{align}
to the final kinetic energy, $E'$:
\begin{align}
\begin{split}
    E' &= \frac{1}{2}\mu_N v'^2 \\
       &= \frac{1}{2}\mu_N \bigg(\vec{v} + \frac{\vec{q}}{\mu_N}\bigg)^2
\end{split}
\end{align}
where $\mu_N=(m_\chi m_N)/(m_\chi + m_N)$ is the WIMP-nucleon reduced mass.
This leaves us with:
\begin{equation}
    \vec{v} \cdot \vec{q} = \frac{q^2}{2\mu_N}
\end{equation}
Finally, we want the operators to have real eigenvalues corresponding to physical quantities, that is to say, Hermitian.
Neither $\vec{q}$ nor $\vec{v}$ are Hermitian but can be made so by:
\begin{equation}
\begin{split}
    &\vec{q} \rightarrow i\vec{q} \\
    &\vec{v} \rightarrow \vec{v}^{\bot} = \vec{v} + \frac{\vec{q}}{\mu_N}
\end{split}
\end{equation}
These four quantities, $i\vec{q}$, $\vec{v}^{\bot}$, $\vec{S}_N$ and $\vec{S}_\chi$, make up the complete set of parameters which we need to describe our interaction.
We can then take all of the combinations of these variables to leave us with 15 operators:
\begin{equation}
\begin{array}{lcl}
\Operator_{1}=1_{\chi}1_N, \quad \Operator_{2}=\left(v^{\perp}\right)^{2}, \quad \Operator_{3}=i \vec{S}_{N} \cdot\left(\frac{\vec{q}}{m_N} \times \vec{v}^{\perp}\right) \\ 
\Operator_{4}=\vec{S}_{\chi} \cdot \vec{S}_{N}, \quad \Operator_{5}=i \vec{S}_{\chi} \cdot(\frac{\vec{q}}{m_N} \times \vec{v}^{\perp}) \\ 
\Operator_{6}=\left(\vec{S}_{\chi} \cdot \frac{\vec{q}}{m_N}\right)\left(\vec{S}_{N} \cdot \frac{\vec{q}}{m_N}\right) \\
\Operator_{7}=\vec{S}_{N} \cdot \vec{v}^{\perp}, \quad \Operator_{8}=\vec{S}_{\chi} \cdot \vec{v}^{\perp} \\
\Operator_{9}=i \vec{S}_{\chi} \cdot\left(\vec{S}_{N} \times \frac{\vec{q}}{m_N}\right), \quad \Operator_{10}=i \vec{S}_{N} \cdot \frac{\vec{q}}{m_N} \\ 
\Operator_{11}=i \vec{S}_{\chi} \cdot \frac{\vec{q}}{m_N}, \quad \Operator_{12} =\vec{S}_{\chi} \cdot\left(\vec{S}_{N} \times \vec{v}^{\perp}\right) \\
\Operator_{13} =i\left(\vec{S}_{\chi} \cdot \vec{v}^{\perp}\right)\left(\vec{S}_{N} \cdot \frac{\vec{q}}{m_N}\right) \\ 
\Operator_{14} =i\left(\vec{S}_{\chi} \cdot \frac{\vec{q}}{m_N}\right)\left(\vec{S}_{N} \cdot \vec{v}^{\perp}\right) \\ 
\Operator_{15} =-\left(\vec{S}_{\chi} \cdot \frac{\vec{q}}{m_N}\right)\left(\left(\vec{S}_{N} \times \vec{v}^{\perp}\right) \cdot \frac{\vec{q}}{m_N}\right)
\end{array}
\label{eq:EFT_Operators}
\end{equation}
%$\Operator_{1}$-$\Operator_{11}$ can be attributed to the exchange of spin-0 or spin-1 mediators, where as $\Operator_{12}$-$\Operator_{15}$ do not.
Some literature also include $\Operator_{16}=-((\vec{S}_\chi \times \vec{v}^{\bot}) \cdot \vec{q})(\vec{S}_N) \cdot \vec{q})$, though as it is just a linear combination of $\Operator_{12}$ and $\Operator_{15}$ it does not need to be included for the most general description.
Typically $\Operator_{2}$ is disregarded due to the $v^{2}$ dependence and so does not appear in non-relativistic models and has such will be dropped here as well.
Although we have constrained ourselves to elastic scatter, this theory can be trivially extended to the inelastic case by $\vec{v}^{\perp} \rightarrow \vec{v}^{\perp} + \frac{\delta_m}{|\vec{q}|^2}\vec{q}$ \cite{inelastics_eft_ref}.
\par
Before we continue, it is important to note that the couplings to the nucleon components are not necessarily identical to each other.
This means that each operator, $\Operator$, really represents 2 operators: $\{proton,neutron\}$ or with isospin dependency $\{isoscalar,isovector\}$.
Isoscalar particles are singlets with a total isospin of 0, whereas isovector particles are triplet states with a total isospin of 1.
Any analysis has to make a decision as to which basis to use.
Historically there has been little consistency, with often the same experiment changing between $\{neutron, proton\}$ basis and $\{isoscalar, isovector\}$ basis between data runs.
The choice for some experiments to adopt the $\{neutron, proton\}$ basis has been driven by similarity in reporting results with the standard spin-dependent analysis.
In the last few years however, $\{isoscalar, isovector\}$ basis has become more common, with CDMS \cite{cdms_eft_ref}, XENON100 \cite{xenon100_eft_ref}, DEAP-3600 \cite{deap3600_eft_ref} and PandaX-II \cite{pandax_2_eft_ref} all reporting results in this basis.
The translation is fairly trivial with the coupling constants between isoscalar ($c^0$), isovector ($c^1$), proton ($c^p$) and neutron ($c^n$) given by:
\begin{equation}
\begin{split}
    c^0 &= \frac{1}{2}(c^p + c^n)  \\
    c^1 &= \frac{1}{2}(c^p - c^n) 
\end{split}
\label{eq:eft_iso_to_pn}
\end{equation}
In practical terms, this means that the Lagrangian (\autoref{eq:eft_initial_lagrangian}) requires a slight alteration to:
\begin{equation}
    \mathcal{L}_{int}  = \sum_{\tau = (0,1)} \sum^{15}_{i=1}c^{\tau}_{i} \Operator_i \chi_1 \chi_2 N_1 N_2
\end{equation}
for $\{isoscalar,isovector\}$, and to:
\begin{equation}
    \mathcal{L}_{int} = \sum_{N = (p,n),(\tau)} \sum^{15}_{i=1}c^{(N)}_{i} \Operator_i \chi_1 \chi_2 N_1 N_2
\end{equation}
for $\{neutron,proton\}$.
$i$ is to sum over each operator.
A priori we know nothing about the strength of these coefficients, $c_i$, and so we cannot say that we know one operator is more significant than another operator.

\subsection{Treatment of the nucleus}
\par
Now in order to relate the theory outlined above to what is observable experimentally, we must consider that a dark matter particle interacts with nucleons that are bound in nuclei rather than free nucleons.
As such, the matrix element of each operator needs to be evaluated inside the target nucleus and so inserted between nuclear states.
The way this is performed in \cite{Fitzpatrick_2013_ref} is by decomposing the velocity into the component that acts on the centre-of-mass of the nucleus and the component that is dependent on the relative velocity of the nucleus.
The resultant spin-averaged matrix element is given by:
\begin{equation}
    \frac{1}{(2j_A + 1)}\frac{1}{(2j_\chi + 1)} \sum_{spins} |\mathcal{M}|^2 \equiv
    \frac{m_A^2}{m_N^2} \sum_{i,j=1}^{15} \sum_{a,b=0,1} c_i^{a}c_{j}^{b} F_{ij}^{a,b} (v^2,q^2)
    \label{eq:eft_scattering_amplitude_in_terms_of_operator_form_factors}
\end{equation}
where $m_N$ is the nucleon mass, $m_A$ is the target nucleus mass, and $j_A$ and $j_\chi$ are the spins of the nucleus and WIMP respectively. 
$F^{a,b}_{ij} (v^2,q^2)$ is the unique form factor associated with each nucleus and combination of WIMP-nucleon operators, which is dependent upon both the velocity and momentum transfer.
The combination of two form factors is due to going from $\mathcal{M}$ to $|\mathcal{M}|^2$, so each term contains two EFT operators.
A derivation of some form factors can be found in Appendix A of \cite{Fitzpatrick_2013_ref}.

\par
Substituting \autoref{eq:eft_scattering_amplitude_in_terms_of_operator_form_factors} into \autoref{eq:wimp_differential_rate} gives the WIMP-nucleon differential rate:
\begin{equation}
    \frac{dR}{dE_R} = \frac{\rho_{\chi}}{32 \pi m_\chi^3 m_N^2} \int^{\infty}_{v>v_{min}} \frac{f(\vec{v})}{v} \sum_{i,j=1}^{15} \sum_{a,b=0,1} c_i^a c_j^b F_{i,j}^{a,b} d^3 v
    \label{eq:final_eft_differential_cross_section}
\end{equation}
This recoil rate per recoil energy produced an expected signal which can then be searched for.

\subsection{Experimental Searches}
\par
Due to the complexity of evaluating the nuclear form factors and the uncertainties in the parameters, direct dark matter searches have generally focused on setting limits on the individual operator coupling constants.
This is performed by simply evaluating the scattering amplitude assuming a single operator.
In this case, for the isoscalar scatter rate of operator $i$, \autoref{eq:final_eft_differential_cross_section} simplifies to:
\begin{equation}
    \frac{dR}{dE_R} = \frac{\rho_{\chi} {c_i^{0}}^2}{32 \pi m_\chi^3 m_N^2} \int^{\infty}_{v>v_{min}} \frac{f(\vec{v})}{v} F_{i,i}^{0,0} d^3 v
    \label{eq:final_eft_differential_cross_section}
\end{equation}
The current best limits come from LUX \cite{LUX_RUN4_EFT_2021}, which was a study performed in the \{$neutron,proton$\} basis.
A mass point for each operator was also analysed in the $\{isoscale, isovector\}$ basis and compared to XENON100 \cite{xenon100_eft_ref} and shown to be roughly equivalent.
The reader will have to wait until \autoref{chap:analysis_eft_work} to see these, along with the author's results.
It is interesting to note that a recent publication by Panda-X performed a generalised spin analysis using linear combinations of the operators \cite{pandax_2_eft_ref}.

\par
Thinking about the scattering slightly more simplistically, the differential rate can be expressed as \cite{simple_eft_ref}:
\begin{equation}
    \frac{d\sigma}{dE_R} \approx G_F^2 \sum_{i} R_i (\vec{v}^{\perp 2}, \frac{\vec{q}^2}{m_N^2}) W_i(q^2,b^2)
\end{equation}
where $W_i(q^2,b^2)$ encompasses the nuclear tensor and $R_i (\vec{v}^{\perp 2}, \frac{\vec{q}^2}{m_N^2})$ is the WIMP tensor containing all of the dark matter particle physics.
$b$ is the nuclear size.
The design of a direct dark matter experiment sets the nuclear charge, spin and isospin to determine $R_i$.
This is the choice of target nucleon, such as Xenon.
$W_i$ is then probed experimentally by searching for the recoil energy.
If no recoils our observed, then the contribution of $W_i$ is reduced, which sets an upper limit on what $\sigma$ can be.



\iffalse


In order to assist in this, we first decompose $\vec{v}$ of each nucleon into the velocity with respect to the centre of mass $\vec{v}_{N}$ and the nucleus centre of mass velocity $\vec{v}_{A}$.
This can also be done for the transverse velocity $\vec{v}^{\perp}$ where $\vec{v}^{\perp}_{A}=\vec{v}_A + \vec{q}/2\mu_{A}$ and $\vec{v}^{\perp}_{N}=-1/2(\vec{v}_{N} + \vec{v}^{'}_{N})$.

\par
Putting this decomposition together we can define our interaction Lagrangian as a linear combination of these operators in the centre of mass frame of the nucleus:
\begin{equation}
\begin{split}
    \mathcal{L}_{int}\quad  & =\quad c_1 \\
             & +\quad ic_3 \vec{S}_{N} \cdot ( \vec{q} \times \vec{v}^{\perp}_{A} ) + ic_3 \vec{S}_{N}
             \cdot( \vec{q} \times \vec{v}^{\perp}_{N} ) \\
             & +\quad c_4 \vec{S}_{\chi} \cdot \vec{S}_{N} \\
             & +\quad ic_5 \vec{S}_{\chi} \cdot(\vec{q} \times \vec{v}^{\perp}_{A}) + ic_5 \vec{S}_{\chi} \cdot ( \vec{q} \times \vec{v}^{\perp}_{N} ) \\
             & +\quad c_6 ( \vec{S}_{\chi} \cdot \vec{q} ) (\vec{S}_{N} \cdot \vec{q} ) \\
             & +\quad c_7 \vec{S}_{N} \cdot \vec{v}^{\perp}_{A} + c_7 \vec{S}_{N} \cdot \vec{v}^{\perp}_{N} \\
             & +\quad c_8 \vec{S}_{\chi} \cdot \vec{v}^{\perp}_{A} + c_8 \vec{S}_{\chi} \cdot \vec{v}^{\perp}_{N} \\
             & +\quad ic_9 \vec{S}_{\chi} \cdot ( \vec{S}_{N} \times \vec{q} ) \\
             & +\quad ic_{10} \vec{S}_{N} \cdot \vec{q} \\
             & +\quad ic_{11} \vec{S}_{\chi} \cdot \vec{q} \\
             & +\quad c_{12} \vec{S}_{\chi} \cdot ( \vec{S}_{N} \times \vec{v}^{\perp}_{A} ) + c_{12} \vec{S}_{\chi} \cdot ( \vec{S}_{N} \times \vec{v}^{\perp}_{N} ) \\
             & +\quad ic_{13} ( \vec{S}_{\chi} \cdot \vec{v}^{\perp}_{A} ) ( \vec{S}_{N} \cdot \vec{q} ) + ic_{13} ( \vec{S}_{\chi} \cdot \vec{v}^{\perp}_{N} ) ( \vec{S}_{N} \cdot \vec{q} ) \\
             & +\quad ic_{14} ( \vec{S}_{\chi} \cdot \vec{q} ) ( \vec{S}_{N} \cdot \vec{v}^{\perp}_{A} ) + ic_{14} ( \vec{S}_{\chi} \cdot \vec{q} ) ( \vec{S}_{N} \cdot \vec{v}^{\perp}_{N} ) \\
             & -\quad c_{15}(\vec{S}_{\chi} \cdot \vec{q}) ( ( \vec{S}_{N} \times \vec{v}^{\perp}_{A} ) \cdot \vec{q} ) - c_{15} ( \vec{S}_{\chi} \cdot \vec{q} ) ( ( \vec{S}_{N} \times \vec{v}^{\perp}_{N} ) \cdot \vec{q} )
\end{split}
\label{eq:eft_operator_lagrangian_com}
\end{equation}
The equation above has been written such that it is only in terms of the degrees of freedom available to the nucleus ($\vec{S}_{N},\vec{v}^{\perp}_{N}$).
This shows us that there are just three scalar quantities: 
\begin{equation}
    1,\; \vec{v}^{\perp}_{N} \cdot \vec{v}^{\perp}_{N}, \; \text{and} \; \vec{S}_{N} \cdot \vec{v}^{\perp}_{N}
\end{equation}
and three nucleus-dependent currents:
\begin{equation}
    \vec{S}_{N},\; \vec{v}^{\perp}_{N}, \; \text{and} \; \vec{S}_{N} \times \vec{v}^{\perp}_{N}
\end{equation}
that can can be created.
As before we will disregard $\vec{v}^{\perp}_{N} \cdot \vec{v}^{\perp}_{N}$ as it does not appear in the lowest order, leaving us with five unique nuclear charges and currents that can couple to our dark matter.

\par
We can rearrange our Lagrangian (\autoref{eq:eft_operator_lagrangian_com}) to be linear combinations of these:
\begin{equation}
\begin{split}
    \mathcal{L}_{int}\quad  & =\quad \Bigl\{ c_1 + ic_{5}\vec{S}_{\chi} \cdot (\vec{q} \times \vec{v}^{\perp}_{A}) + c_8 (\vec{S}_{\chi} \cdot \vec{v}^{\perp}_{A}) + ic_{11} (\vec{S}_{\chi} \cdot \vec{q} ) \Bigl\} \\
                            & +\quad \Bigl\{ c_7 + ic_{14}(\vec{S}_{\chi} \cdot \vec{q}) \Bigl\} \cdot [\vec{S}_{N} \cdot \vec{v}^{\perp}_{N}] \\
                            & +\quad \Bigl\{ ic_3 (\vec{q} \times \vec{v}^{\perp}_{A}) + c_4\vec{S}_{\chi} + c_6 (\vec{S}_{\chi} \cdot \vec{q} ) \vec{q} + c_7 \vec{v}^{\perp}_{A} + ic_9 ( \vec{q} \times \vec{S}_{\chi} ) + ic_{10} \vec{q} \\
                            & \qquad+ c_{12} (\vec{v}^{\perp}_{A} \times \vec{S}_{\chi}) + ic_{13} (\vec{v}^{\perp}_{A} \cdot \vec{S}_{\chi}) \vec{q} + ic_{14}(\vec{q} \cdot \vec{S}_{\chi})\vec{v}^{\perp}_{A} - c_{15}(\vec{S}_{\chi} \cdot \vec{q}) \vec{q} \Bigl\} \cdot [\vec{S}_{N}] \\
                            & +\quad \Bigl\{ ic_5 (\vec{S}_{\chi} \times \vec{q}) + c_8 \vec{S}_{\chi} \Bigl\} \cdot [\vec{v}^{\perp}_{N}] \\
                            & +\quad \Bigl\{ ic_3 \vec{q} + c_{12} \vec{S}_{\chi} - ic_{13} (\vec{q} \times \vec{S}_{\chi}) - c_{15} (\vec{q} \cdot \vec{S}_{\chi}) \vec{q} \Bigl\} \cdot [\vec{S}_{N} \times \vec{v}^{\perp}_{N}] 
\end{split}
\label{eq:eft_operator_lagrangian_charges_and_currents}
\end{equation}
In \autoref{eq:eft_operator_lagrangian_charges_and_currents} each term inside the curly brackets which can be explicitly names:
\begin{equation}
\begin{split}
    l_0  & = c_1 - ic_5 \vec{v}^{\perp}_{A} \cdot(\vec{q} \times \vec{S}_\chi) + c_8 \vec{S}_\chi \cdot \vec{v}^{\perp}_{A} + ic_{11} \vec{S}_\chi \cdot \vec{q} \\
    l^A_0 &= c_7 + ic_{14} (\vec{S}_\chi \cdot \vec{q}) \\
    \vec{l}_5 &= \frac{1}{2} \big[ ic_3 (\vec{q} \times \vec{v}^{\perp}_{A}) + c_4 \vec{S}_\chi + c_6 (\vec{S}_\chi \cdot \vec{q}) \vec{q} + c_7 \vec{v}^{\perp}_{A} + ic_9 (\vec{q} \times \vec{S}_\chi) + ic_{10} \vec{q} \\
    &\qquad+ c_12 (\vec{v}^{\perp}_{A} \times \vec{S}_\chi) + ic_{13} (\vec{v}^{\perp}_{A} \cdot \vec{S}_\chi) \vec{q} + ic_{14}(\vec{q} \cdot \vec{S}_\chi)\vec{v}^{\perp}_{A} - c_{15} (\vec{S}_\chi \cdot \vec{q} ) \vec{q} \bigg] \\
    \vec{l}_M &= ic_5 (\vec{S}_\chi \times \vec{q}) - c_8 \vec{S}_\chi \\
    \vec{l}_E &= -\frac{1}{2} \bigg[ c_3 + ic_{12} \vec{S}_\chi - c_{13} (\vec{q} \times \vec{S}_\chi) - ic_{15} (\vec{q} \cdot \vec{S}_{\chi}) \vec{q} \bigg] \vec{q}
\end{split}
\label{eq:eft_operator_lagrangian_charges_and_currents_2}
\end{equation}
This allows the Lagrangian to be written as:
\begin{equation}
    \mathcal{L} = l_01 + l_0^A[-2\vec{v}^{\perp}_N \cdot \vec{S}_N] + \vec{l}_{5} \cdot [2\vec{S}_N] + \vec{l}_{M} \cdot [-\vec{v}^{\perp}_N] + \vec{l}_{E} \cdot [2i\vec{v}^{\perp}_N \times \vec{S}_{N} ]
\end{equation}
We still have only defined a WIMP-nucleon interaction, and so we need to go further to obtain a WIMP-nucleus interaction: which is the sum of the contributions from each nucleon:
\begin{equation}
    \mathcal{L}^{\text{Nucleus}}_{\text{int}} = \sum_{i}^{A} \mathcal{L}^{N_i}_{\text{int}}
\end{equation}
In order to simplify the scattering amplitude evaluation and to maintain consistency with literature \cite{Fitzpatrick_2013_ref}, we will apply a set of transformations to go from momentum space to coordinate space:
\begin{equation}
    \begin{split}
        -\vec{v}^{\perp}_{N_i} &= \frac{\vec{p}_{N_i} + \vec{p}^{'}_{N_i}}{2m_N} \rightarrow \frac{1}{2m_N}i \Bigg( \vec{\nabla}\delta(\vec{r - \vec{r}_i}) - \delta(\vec{r} - \vec{r}_i) \vec{\nabla} \Bigg) \\
        \vec{S}_{N_i} &= \vec{\sigma}(i) \\
        1 &\rightarrow \delta(\vec{r} - \vec{r}_i)
    \end{split}
\end{equation}
where $\vec{r}_i$ is the position of the $i^{th}$ nucleon with respect to the centre of mass of the nuclei, $\vec{r}$ is the position of the dark matter particle with respect to the centre of mass of the nuclei and $\vec{\sigma}(i)$ is the spin operator in terms of the Pauli spin matrices.
$\vec{p}_{N_i}$ and $\vec{p}^{'}_{N_i}$ are the initial and final momenta of the $i^{th}$ nucleon.
By including a plane wave of the form $e^{-i \vec{q}\cdot \vec{r}}$ to each term we are able to consider a nucleon at every location.
This leaves us with a Hamiltonian density for the WIMP-nucleus interaction of:
\begin{equation}
\begin{split}
    \mathcal{H}(\vec{r})\quad  & =\quad \sum^{A}_{i=1} l_{0}(i) \delta(\vec{r} - \vec{r}_i) e^{-i\vec{q}\cdot \vec{r}} \\
                               & +\quad  \sum^{A}_{i=1} l^A_0 (i) \frac{i}{2m_N} \Bigg[ \vec{\nabla} \cdot \vec{\sigma}(i) \delta(\vec{r} - \vec{r}_i) e^{-i\vec{q}\cdot \vec{r}} - e^{-i\vec{q}\cdot \vec{r}} \delta(\vec{r} - \vec{r}_i) \vec{\sigma}(i) \cdot \vec{\nabla} \Bigg] \\
                               & +\quad  \sum^{S}_{i=1} \vec{l}_5 (i) \cdot \vec{\sigma}(i)\delta(\vec{r} - \vec{r}_i)e^{-i\vec{q}\cdot \vec{r}} \\
                               & +\quad  \sum^{A}_{i=1} \vec{l}_M (i) \cdot \frac{i}{2m_N} \Bigg[ \vec{\nabla} \delta(\vec{r} - \vec{r}_i)e^{-i\vec{q}\cdot \vec{r}} - e^{-i\vec{q}\cdot \vec{r}}\delta(\vec{r} - \vec{r}_i)\vec{\nabla} \Bigg] \\
                               & +\quad \sum^{A}_{i=1} \vec{l}_E (i) \cdot \frac{1}{2m_N} \Bigg[ \vec{\nabla} \times \vec{\sigma}(i)\delta(\vec{r} - \vec{r}_i)e^{-i\vec{q}\cdot \vec{r}} + e^{-i\vec{q}\cdot \vec{r}}\delta(\vec{r} - \vec{r}_i) \vec{\sigma}(i) \times \vec{\nabla} \Bigg]
\end{split}
\label{eq:eft_hamiltonian_density}
\end{equation}

\par
We can then integrate over the nucleon positions to get the Hamiltonian, H.
This as it turns out is the easiest step it just contracting the delta functions and replacing $e^{-i\vec{q}\cdot \vec{r}}$ with $e^{-i\vec{q}\cdot \vec{r}_i}$.
Which leaves us with:
\begin{equation}
\begin{split}
    H\quad & =\quad \sum^{A}_{i=1} l_{0}(i) e^{-i\vec{q}\cdot \vec{r}_i} \\
           & +\quad \sum^{A}_{i=1} l^A_0 (i) \frac{i}{2m_N} \Bigg[ \vec{\nabla} \cdot \vec{\sigma}(i) e^{-i\vec{q}\cdot \vec{r}_i} - e^{-i\vec{q}\cdot \vec{r}_i} \vec{\sigma}(i) \cdot \vec{\nabla} \Bigg] \\
           & +\quad \sum^{S}_{i=1} \vec{l}_5 (i) \cdot \vec{\sigma}(i) e^{-i\vec{q}\cdot \vec{r}_i} \\
           & +\quad \sum^{A}_{i=1} \vec{l}_M (i) \cdot \frac{i}{2m_N} \Bigg[ \vec{\nabla} e^{-i\vec{q}\cdot \vec{r}_i} - e^{-i\vec{q}\cdot \vec{r}_i}\vec{\nabla} \Bigg] \\
           & +\quad \sum^{A}_{i=1} \vec{l}_E (i) \cdot \frac{1}{2m_N} \Bigg[ \vec{\nabla} \times \vec{\sigma}(i)e^{-i\vec{q}\cdot \vec{r}_i} + e^{-i\vec{q}\cdot \vec{r}_i} \vec{\sigma}(i) \times \vec{\nabla} \Bigg]
\end{split}
\label{eq:eft_hamiltonian}
\end{equation}
We are then able to calculate the scattering amplitude for the interaction in the same way as before for the SI case, by averaging over the initial spins and summing over the final spins:
\begin{equation}
    | \mathcal{M} |^2  = |\langle j_\chi,M_\chi;j_N M_N | H | j_\chi,M_\chi;j_N M_N \rangle |^2
\end{equation}
Before we show the explicit result of this, we should first look back towards our Hamiltonian.
It is comprised of a number of terms, each of which contain the couple constant for a single EFT operator.
We are able to express our scattering matrix element in a similar fashion: as the sum of a number of smaller terms, each of which involving a single operator.
In this case, we can write it as:
\begin{equation}
    \frac{1}{(2j_A + 1)}\frac{1}{(2j_\chi + 1)} \sum_{spins} |\mathcal{M}|^2 \equiv
    \frac{m_A^2}{m_N^2} \sum_{i,j=1}^{15} \sum_{a,b=0,1} c_i^{a}c_{j}^{b} F_{ij}^{a,b} (v^2,q^2)
    \label{eq:eft_scattering_amplitude_in_terms_of_operator_form_factors}
\end{equation}
In \autoref{eq:eft_scattering_amplitude_in_terms_of_operator_form_factors} we have introduced $F_{ij}^{a,b}(v^2,q^2)$, which is the unique form factor associated to each nucleus and combination of WIMP-nucleon operators.
\par
The actual evaluation of these nuclear form factors is not particularly straightforward, and the choice nuclear model is the most accurate still debated, can have a non-negligible impact on any dark matter sensitivity.
The approach adopted in \cite{Fitzpatrick_2013_ref} is to perform a multipole decomposition where the following identities are used:
\begin{equation}
\begin{split}
e^{i \vec{q} \cdot \vec{r}_i}\;&=\;\sum_{J=0}^{\infty} \sqrt{4 \pi} \sqrt{2 J+1} i^J j_J\left(q r_i\right) Y_{J 0}\left(\Omega_{r_i}\right) \\
\hat{e}_\lambda e^{i \vec{q} \cdot \vec{r}_i} \; &= \; 
\begin{dcases}
\sum_{J=0}^{\infty} \sqrt{4 \pi} \sqrt{2 J+1} i^{J-1} \frac{\vec{\nabla}_i}{q} j_J\left(q r_i\right) Y_{J 0}\left(\Omega_{r_i}\right) & \lambda=0 \\
\sum_{J \geq 1}^{\infty} \sqrt{2 \pi} \sqrt{2 J+1} i^{J-2}\left[\lambda j_J\left(q r_i\right) \vec{Y}_{J J 1}^\lambda\left(\Omega_{r_i}\right)+\frac{\vec{\nabla}_i}{q} \times j_J\left(q r_i\right) \vec{Y}_{J J 1}^\lambda\left(\Omega_{r_i}\right)\right] & \lambda=\pm 1
\end{dcases}
\end{split}
\label{eq:eft_multipole_expansion}
\end{equation}
In the above equation, $j_J$ is a spherical Bessel function, $Y_{LM}$ is a spherical harmonic function, and $\vec{Y}^{\lambda}_{LM}$ is a vector spherical harmonic.
$\Omega$ is the direction of the vector $\vec{r}_i$.
The reason for this multipole expansion approach is that it allows for exploitation of the assumption of CP and parity symmetry in the nuclear ground state.
Not only do most multipoles vanish under this assumption, but the majority of off-diagonal terms disappear as well.
During this expansion the intermittent expressions are not friendly and as such are not included here, but if the reader is curious they are directed to Appendix A.1 of \cite{Fitzpatrick_2013_ref}, though it is also recommended that both \cite{weak_multipole_expansion_ref} and \cite{semileptonic_multipole_expansion_ref} be read for an improved understanding of the calculation.
\par
We can now arrive at the dark matter scattering amplitude:
\begin{equation}
\begin{split}
    | \mathcal{M} |^2  &= |\langle j_\chi,M_\chi;j_N M_N | H | j_\chi,M_\chi;j_N M_N \rangle |^2 \\
    &= 4 \pi \sum_{i=1}^{A} \left[ \sum_{J=1,3,...}^{\infty} | \langle J_i||\vec{l}_5 \cdot \hat{q} \Sigma_{J}^{''}(q) || J_i \rangle |^2 \right. \\
    &\quad+ \sum_{J=0,2,...}^{\infty} \Bigl\{ | \langle J_i||l_0 M_J (q) || J_i \rangle |^2 + | \langle J_i||\vec{l}_E \cdot \hat{q} \frac{q}{m_N} \Phi^{''}_{J} (q) || J_i \rangle |^2 \\
    &\qquad\qquad\qquad+ 2\text{Re} \Bigl[ \langle J_i || \vec{l}_E \cdot \hat{q} \frac{q}{m_N} \Phi^{''}_{J}(q) || J_i\rangle \langle J_i||l_0 M_{J}(q)||J_i\rangle^*\Bigl] \Bigl\} \\
    &\quad+ \frac{q^2}{2m^2_N} \sum_{J=2,4,...}^{\infty} \Bigl( \langle J_i || \vec{l}_E \tilde{\Phi}_{J}(q) || J_i \rangle \cdot \langle J_i || \vec{l}_M \Delta_{J}(q) || J_i \rangle^* - |\langle J_i || \vec{l}_m \cdot \hat{q}\Delta_{J}(q) ||J_i \rangle |^2 \Bigl) \\
    &\quad+ \sum_{J=1,3,...}^{\infty} \Bigl\{ \frac{q^2}{2m^2_N} \Bigl( \langle J_i || \vec{l}_M \Delta_{J}(q) || J_i \rangle \cdot \langle J_i || \vec{l}_5 \cdot \hat{q}\Delta_{J}(q) || J_i \rangle |^2 \Bigl) \\
    &\qquad\qquad\qquad+ \frac{1}{2} \Bigl( \langle J_i|| \vec{l}_5 \Sigma^{'}_{J}(q) || J_i \rangle \cdot \langle J_i||\vec{l}_5 \Sigma^{'}_{J}(q) || J_i \rangle^2 - |\langle J_i||\vec{l}_5 \cdot \hat{q} \Sigma^{'}_{J} || J_i \rangle |^2 \Bigl) \\
    &\qquad\qquad\qquad+ 2\text{Re} \Bigl[ i\hat{q} \cdot \langle J_i || \vec{l}_M \frac{q}{m_N} \Delta_{J}(q) || J_i \rangle  \times \langle J_i||\vec{l}_{5} \Sigma^{'}_{J}(q) || J_i \rangle^* \Bigl] \Bigl\} \Biggr] 
\end{split}
\label{eq:eft_scattering_amplitude}
\end{equation}
In \autoref{eq:eft_scattering_amplitude} we have introduced six nuclear responses, $M,\Sigma^{'},\Sigma^{''},\nabla,\tilde{\Phi}^{'},\Phi^{''}$. 
Each of which can be written in terms of spherical harmonics previously defined:
\begin{equation}
\begin{split}
    M_{JM}(qr) &\equiv j_J(qr)Y_J M(\Omega_r) \\
    \vec{M}^{M}_{JL} &\equiv j_L (qr) \vec{Y}_{JLM}
\end{split}    
\end{equation}
This allows us to write these nuclear responses as:
\begin{equation}
\begin{split}
    \Delta_{JM}(q\vec{r})\quad &\equiv\quad \vec{M}_{JJ}^{M}(q\vec{r}) \cdot \frac{1}{q}\vec{\nabla} \\
    \Sigma^{'}_{JM}(q\vec{r})\quad &\equiv\quad -i \bigg\{ \frac{1}{q} \vec{\nabla} \times \vec{M}^{M}_{JJ}(q\vec{r}) \bigg\} \cdot \vec{\sigma} \\
    & =\quad (J(J + 1))^{-1}\bigg\{-\sqrt{J}\vec{M}^{M}_{JJ+1}(q\vec{r}) + \sqrt{J+1} \vec{M}^{M}_{JJ-1}(q\vec{r}) \bigg\} \cdot \vec{\sigma} \\
    \Sigma^{''}_{JM}(q\vec{r})\quad &\equiv\quad \bigg\{\frac{1}{q}\vec{\nabla}\vec{M}^{M}_{JJ}(q\vec{r}) \bigg\} \cdot \vec{\sigma} \\
    & =\quad (J(J + 1))^{-1} \bigg\{-\sqrt{J+1}\vec{M}^{M}_{JJ+1}(q\vec{r}) + \sqrt{J}\vec{M}^{M}_{JJ-1}(q\vec{r}) \bigg\} \cdot \vec{\sigma} \\
    \tilde{\Phi}^{'}_{JM}(q\vec{r})\quad &\equiv\quad \bigg( \frac{1}{q}\vec{\nabla} \times \vec{M}^{M}_{JJ}(q\vec{r}) \bigg) \cdot \bigg( \vec{\sigma} \times \frac{1}{q} \vec{\nabla} \bigg) + \frac{1}{2}\vec{M}^{M}_{JJ}(q\vec{r}) \cdot \vec{\sigma} \\
    \Phi^{''}_{JM}(q\vec{r})\quad &\equiv\quad i \bigg( \frac{1}{q}\vec{\nabla}\vec{M}^{M}_{JJ}(q\vec{r}) \bigg) \cdot \bigg( \vec{\sigma} \times \frac{1}{q}\vec{\nabla} \bigg)
\end{split}
\label{eq:eft_nuclear_response_operators}
\end{equation}
Each of these nuclear response operators are directly from electroweak physics - or with simple modifications for which the reader is directed to \cite{Fitzpatrick_2013_ref}.
\par
The form factors we saw in \autoref{eq:eft_scattering_amplitude_in_terms_of_operator_form_factors} can be constructed as a linear combination of nuclear form factors that are associated with these nuclear responses:
\begin{equation}
    F^{a,b}_{ij} = \sum_{k=M,\Sigma^{''},\Sigma^{'},\Delta, \Phi^{''},\tilde{\Phi}^{'}} a_{ijk}(j_\chi,v^2,q^2) F_{k}^{(a,b)}
    \label{eq:eft_form_factor_relation_to_nuclear_form_factors}
\end{equation}
All parameters which depend on our dark matter, including mass, spin and relative velocity, are all contained within the coefficients $a_{ijk}$.
This leaves the nuclear form factors dependent exclusively on the target nucleus.
Each nuclear form factor is defined as:
\begin{equation}
    F^{a,b}_X(q^2) \equiv \frac{4 \pi}{2j + 1} \sum^{2j+1}_{J=1} \langle j || X^{a}_{j} || j \rangle \langle j || X^{b}_{j} || \rangle 
\end{equation}
assuming that there is no interference or, if there is interference between responses:
\begin{equation}
    F^{a,b}_{X,Y}(q^2) \equiv \frac{4 \pi}{2j + 1} \sum^{2j+1}_{J=1} \langle j || X^{a}_{j} || j \rangle \langle j || Y^{b}_{j} || \rangle 
\end{equation}
which is allowed between $M$ and $\Phi^{''}$ and between $\Sigma^{'}$ and $\Sigma^{''}$.

\par
For calculated form factors the reader is directed towards \cite{Fitzpatrick_2013_ref, dmformfactor_ref, nicolelarsen_thesis_ref}.
However, most of these only show the \{$n,p$\} result, so below is provided the conversion to those needed for \{$isoscalar,isovector$\}:
\begin{align}
    \begin{split}
        F_{i,j}^{00}    &= \frac{1}{4} \left( F_{i,j}^{(n,n)} + F_{i,j}^{(p,p)} + F_{i,j}^{(p,n)} + F_{i,j}^{n,p} \right) \\
        F_{i,j}^{01}    &= \frac{1}{4} \left( -F_{i,j}^{(n,n)} + F_{i,j}^{(p,p)} - F_{i,j}^{(p,n)} + F_{i,j}^{n,p} \right) \\
        F_{i,j}^{10}    &= \frac{1}{4} \left( -F_{i,j}^{(n,n)} + F_{i,j}^{(p,p)} + F_{i,j}^{(p,n)} - F_{i,j}^{n,p} \right) \\
        F_{i,j}^{11}    &= \frac{1}{4} \left( F_{i,j}^{(n,n)} + F_{i,j}^{(p,p)} - F_{i,j}^{(p,n)} - F_{i,j}^{n,p} \right)
    \end{split}
\end{align}

\subsection{Scattering Rate}
\par
Now that we have all of the tools needed to calculate the scattering amplitude for any interaction in our theory we can relate this to a scattering rate:
\begin{equation}
    \frac{dR}{dE_R} = N_T \frac{\rho_{\chi}}{32 \pi m_\chi^3 m_A} \int_{v>v_{min}} \frac{1}{v}f(\vec{v}) | \mathcal{M} |^2 d^3 v 
    \label{eq:eft_differential_cross_section}
\end{equation}
In this equation, the spin contributions of the initial states are averaged and the final states are summed.
It should be noted that in \autoref{eq:eft_differential_cross_section} a factor $1/(4m_\chi m_A)^2$ has been introduced.
This is to follow the conversion set out in \cite{dmformfactor_ref}, where this factor is included to account for the normalisation required to match the relativistic WIMP-nucleon interaction operators to the non-relativistic terms.

Combining \autoref{eq:eft_scattering_amplitude_in_terms_of_operator_form_factors} with \autoref{eq:eft_differential_cross_section} give us our final differential rate:

\begin{equation}
    \frac{dR}{dE_R} = N_T \frac{\rho_{\chi} m_A}{32 \pi m_\chi^3 m_N^2} \int_{v>v_{min}} \frac{f(\vec{v})}{v} \sum_{i,j=1}^{15} \sum_{a,b=0,1} c_i^a c_j^b \sum_{k=M,\Sigma^{''},\Sigma^{'},\Delta, \Phi^{''},\tilde{\Phi}^{'}} a_{i,j,k}F_{k}^{(a,b)} d^3 v
    \label{eq:final_eft_differential_cross_section}
\end{equation}

\subsection{EFT Searches}
\par
Due to the complexity of evaluating the nuclear form factors and the uncertainties in the parameters, direct dark matter searches have generally focused on setting limits on the individual operator coupling constants.
This is performed by simply evaluating the scattering amplitude assuming a single operator.
The current best limits come from LUX \cite{LUX_RUN4_EFT_2021}, which was a study performed in the \{$neutron,proton$\} basis.
A mass point for each operator was also analysed in the $\{isoscale, isovector\}$ basis and compared to XENON100 \cite{xenon100_eft_ref} and shown to me roughly equivalent.

\par
It is interesting to note however that a recent publication by Panda-X extended this to a generalised spin analysis, using linear combinations of the operators.
Most notably:
\begin{equation}
\begin{split}
    \text{WIMP Magnetic Moment, nucleon vector current} & -\frac{q^2}{2m_\chi m_M}\Operator_1 + \frac{2m_N}{m_M}\Operator_5 - \frac{2m_N}{m_M}(\frac{q^2}{m_N^2}\Operator_4 - \Operator_6) \\
    \text{WIMP electric dipole moment, nucleon vector current} & \frac{2m_N}{m_M}\Operator_{11} \\
    \text{WIMP magnetic moment, nucleon magnetic moment} & 4(\frac{q^2}{m_M^2}\Operator_4 - \frac{m_N^2}{m_M^2}\Operator_6)
\end{split}
\end{equation}
The new quantity introduced here, $m_M$, is just the strength of the WIMP and nucleon moments being coupled, and is taken to be $m_M \sim m_N$.

\par
Writing optimistically, we can also excess our differential rate as \cite{simple_eft_ref}:
\begin{equation}
    \frac{d\sigma}{dE_R} \approx G_F^2 \sum_{i} R_i (\vec{v}^{\perp 2}, \frac{\vec{q}^2}{m_N^2}) W_i(q^2b^2)
\end{equation}
where $W_i(q^2b^2)$ encompasses the nuclear tensor and $R_i (\vec{v}^{\perp 2}, \frac{\vec{q}^2}{m_N^2})$, is the WIMP tensor, containing all of the dark matter particle physics.
In a direct dark matter experiment, this can be varied to change the nuclear charge, spin, isospin to determine $R_i$.
As there are many different direct dark matter experiment, each with different target nuclei, each with different properties and sensitivities, they combine together to contain the dark matter.

\fi